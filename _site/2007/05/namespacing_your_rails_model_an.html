<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

  <head>
    <title>antman projects. Namespacing Your Rails Model - An Afterthought</title>
    <link href='#' rel="alternate" title="Primary Feed" type="application/rss+xml" />
    <link href="/stylesheets/screen.css" media="screen" rel="Stylesheet" title="antman" type="text/css" />
    <script src="/javascripts/site.js" type="text/javascript"></script>
  </head>
  
  <body>

<div id="main">
  <div id="wrapper">
    <div id="top"></div>
    <div id="box">
      <header>
        <h1> Antman Projects</h1>
      
        <nav role="navigation">
          <ul id="navigator">
            <li><a href="/">home</a></li>
            <li><a href="/projects.html">projects</a></li>
            <li><a href="/archive.html">archive</a></li>
          </ul>
        
        </nav>
      </header>
    </div>
  </div>
</div>
    
        <div id="content">
          <div class="item_perma">
  <div class="item_details">
    <h3>Namespacing Your Rails Model - An Afterthought</h3>
    <h4>Posted  on <a href="/2007/05/namespacing_your_rails_model_an.html" title="Permalink for this post">02 May 2007</a> by <a href="http://twitter.com/antkim003">Anthony Kim</a></h4>
  </div>
  <div class="item_content">
    <p>In an earlier post I wrote about <a href='http://www.paperplanes.de/archives/2007/4/27/namespace_your_rails_model/'>namespacing your Rails model</a>. There&#8217;s an additional issue that must be thought of when doing so. Rails (of course) has conventions dealing with namespaces.</p>

<p>Normally, when you put classes in namespaces, like <code>Admin::User</code>, Rails normally expects this class to be in a folder <code>admin</code> in your <code>app/models</code> directory. Responsible for this is the method <code>load_missing_constant</code> in the module Dependencies, part of ActiveSupport. It also uses the namespace to build the table name. So <code>Admin::User</code> would result in <code>admin_users</code>. This isn&#8217;t always a desirable outcome. Of course you could set a table name explicitly:</p>

<pre><code>class Admin::User &lt; ActiveRecord::Base
  set_table_name &quot;users&quot;
end</code></pre>

<p>If you need to avoid namespace clashes, that&#8217;s an acceptable option. But what if you only want to bring some order to your model directory? You want to create some subfolders to separate your model physically, if only to avoid having dozens of files in the model folder.</p>

<p>This is where <code>load_missing_constant</code> kicks in again. If you don&#8217;t load the files in the subdirectories explicitly, it will assume that the files are in their according namespace. So having a class <code>User</code> in a file <code>user.rb</code> lying in the folder <code>app/models/admin/</code> will lead it to assume <code>User</code> exists in the module <code>Admin</code>. To avoid that you&#8217;ll have to add your model subfolders as load paths. To do that you can add the following line to your environment.rb:</p>

<pre><code>config.load_paths += Dir[&quot;#{RAILS_ROOT}/app/models/[a-z]*&quot;]</code></pre>

<p>This will tell Rails to look for the the files in all subfolders of <code>app/models</code> on startup. This won&#8217;t solve the issue yet, you&#8217;ll still need to explicitly load the classes. So you put the following lines at the end of your <code>environment.rb</code>:</p>

<pre><code>[ &quot;app/models&quot; ].each do |path|
  Dir[&quot;#{RAILS_ROOT}/#{path}/**/*.rb&quot;].each do |file|
    load file
  end
end</code></pre>

<p>That way you&#8217;ll avoid the implicit call to <code>load_missing_constant</code>. You can add directories to the list, e.g. a subdirectory in <code>lib</code>. You could also explicitly require the classes you need, but who wants to do that, really?</p>
  </div>
  <div class="item_meta">
    <div class="item_tags">Tags:
      
    </div>
    <div class="item_hierarchy">Hierarchy:
      
        <a href="/2007/05/microsoft_announces_ironruby.html" title="Previous post">previous</a>
      
      
      
        , <a href="/2007/05/rubyfx_script_announced.html" title="Next post">next</a>
      
      </div>
  </div>
</div>


          <a href="/archive.html">&lt;&lt; Archive</a> | <a href="http://google.com" onclick="Element.toggle('search_content');return false;">Search</a> | <a href="http://feeds.feedburner.com/" title="Full-text RSS feed">RSS Feed</a> 


          <div id="search_content" style="display:none; margin-top:10px"> 
            <form action="http://www.google.com/search" id="search_form" method="get">
              <div id="search"> 
                <b>Search:</b>&nbsp;&nbsp;<input type="text" name="q" id="q" value="Enter your terms, hit enter" onfocus="searchFocus()"/> 
              </div> 
            </form>
          </div>    
        </div>

        
        <footer>
          <div id="footer_text">&copy; antman 2013 | All Rights Reserved. </div>
        <footer>
      </div>

    </div>

<script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '4e390748f5a1f54cd0000001');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>

</body>
</html>
